---
layout: single
title: "Projects"
permalink: /projects/
author_profile: true
---

{% include base_path %}

<div class="projects-toolbar">
  <div class="tags-filter" id="projects-tags"></div>
</div>

<div class="projects-grid" id="projects-grid">
  {%- assign ordered = site.projects | where_exp: 'p', 'p.order != nil' | sort: 'order' -%}
  {%- assign unordered = site.projects | where_exp: 'p', 'p.order == nil' | sort: 'date' | reverse -%}
  {%- assign items = ordered | concat: unordered -%}
  {% for p in items %}
    {%- assign now_ymd = site.time | date: '%Y%m%d' -%}
    {%- assign start_raw = p.start | default: '' -%}
    {%- assign start_dash = start_raw | replace: '.', '-' | replace: '/', '-' -%}
    {%- assign start_ymd = start_dash | date: '%Y%m%d' -%}
    {%- assign end_raw = p.end | default: '' -%}
    {%- assign end_lc = end_raw | downcase -%}
    {%- if end_raw and end_lc != 'present' and end_lc != 'now' -%}
      {%- assign end_dash = end_raw | replace: '.', '-' | replace: '/', '-' -%}
      {%- assign end_ymd = end_dash | date: '%Y%m%d' -%}
    {%- else -%}
      {%- assign end_ymd = now_ymd -%}
    {%- endif -%}
    {%- assign ongoing = false -%}
    {%- if start_ymd and start_ymd != '' -%}
      {%- if start_ymd <= now_ymd and now_ymd <= end_ymd -%}
        {%- assign ongoing = true -%}
      {%- endif -%}
    {%- endif -%}
    {% assign text = p.summary | default: p.excerpt | default: p.content | strip_html | strip_newlines %}
  {% assign preview = text | truncatewords: 20, '…' %}
  <article class="project-card{% if ongoing %} ongoing{% endif %}" data-tags="{{ p.tags | join: ',' }}" data-date="{{ p.date | date: '%Y-%m-%d' }}" data-ongoing="{{ ongoing }}">
      <a class="card-link" href="{{ p.url | relative_url }}">
        <div class="card-media">
          {% if p.cover %}
            <img src="{{ p.cover | relative_url }}" alt="{{ p.title }} cover" loading="lazy" />
          {% else %}
            <div class="card-placeholder" aria-hidden="true"></div>
          {% endif %}
        </div>
        <div class="card-body">
          {% if p.tags and p.tags.size > 0 %}
            <div class="card-chips">
              {% for t in p.tags %}<span class="chip" data-tag="{{ t }}">{{ t }}</span>{% endfor %}
            </div>
          {% endif %}
          <h3 class="card-title">{{ p.title }}</h3>
          {% assign has_range = p.start or p.end %}
          {% if has_range %}
            {% assign start_str = p.start | date: '%Y.%m' %}
            {% if p.end %}
              {% assign end_lc = p.end | downcase %}
              {% if end_lc == 'present' or end_lc == 'now' %}
                {% assign end_str = 'Until now' %}
              {% else %}
                {% assign end_str = p.end | date: '%Y.%m' %}
              {% endif %}
            {% endif %}
            <div class="card-meta">{{ start_str }} — {{ end_str | default: 'Until now' }}</div>
          {% else %}
            <div class="card-meta">{{ p.date | date: '%Y.%m.%d' }}</div>
          {% endif %}
          {% if p.funding %}
            <div class="card-funding"><span class="label">Funding:</span>
              {%- assign funds = p.funding | split: ';' -%}
              {%- assign rendered = 0 -%}
              {%- assign extras = 0 -%}
              {%- assign extras_list = '' -%}
              {%- for f in funds -%}
                {%- assign item = f | strip -%}
                {%- if item != '' -%}
                  {%- if rendered < 2 -%}
                    <span class="funding-chip">{{ item }}</span>
                    {%- assign rendered = rendered | plus: 1 -%}
                  {%- else -%}
                    {%- assign extras = extras | plus: 1 -%}
                    {%- if extras_list == '' -%}
                      {%- assign extras_list = item -%}
                    {%- else -%}
                      {%- assign extras_list = extras_list | append: ', ' | append: item -%}
                    {%- endif -%}
                  {%- endif -%}
                {%- endif -%}
              {%- endfor -%}
              {%- if extras > 0 -%}<span class="funding-chip more" title="{{ extras_list }}">+{{ extras }}</span>{%- endif -%}
            </div>
          {% endif %}
          <p class="card-preview">{{ preview }}</p>
        </div>
      </a>
    </article>
  {% endfor %}
  {% if items == empty %}
    <p>No projects yet.</p>
  {% endif %}
</div>

<script>
  (function(){
    function buildTagSet(){
      var set = new Set();
      document.querySelectorAll('#projects-grid .project-card').forEach(function(card){
        (card.dataset.tags || '').split(',').filter(Boolean).forEach(function(t){ set.add(t.trim()); });
      });
      return Array.from(set).sort();
    }
    function renderFilters(tags){
      var wrap = document.getElementById('projects-tags');
      if (!wrap) return;
      var allBtn = document.createElement('button');
      allBtn.className = 'pf-btn active';
      allBtn.dataset.tag = '';
      allBtn.textContent = 'All';
      wrap.appendChild(allBtn);
      tags.forEach(function(t){
        var b = document.createElement('button');
        b.className = 'pf-btn'; b.dataset.tag = t; b.textContent = t; wrap.appendChild(b);
      });
    }
    function applyFilter(tag){
      var cards = Array.from(document.querySelectorAll('#projects-grid .project-card'));
      cards.forEach(function(c){
        var tags = (c.dataset.tags || '').split(',').map(function(s){return s.trim();});
        var show = !tag || tags.indexOf(tag) !== -1;
        c.style.display = show ? '' : 'none';
      });
    }
    function wire(){
      var tags = buildTagSet();
      renderFilters(tags);
      var bar = document.getElementById('projects-tags');
      if (!bar) return;
      bar.addEventListener('click', function(e){
        var btn = e.target.closest('.pf-btn');
        if (!btn) return;
        bar.querySelectorAll('.pf-btn').forEach(function(b){ b.classList.remove('active'); });
        btn.classList.add('active');
        applyFilter(btn.dataset.tag || '');
      });
    }
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', wire); else wire();
  })();
</script>

